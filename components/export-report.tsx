"use client"

import { Button } from "@/components/ui/button"

interface ExportReportProps {
  edges: Array<{ source: string; target: string; weight: number }>
  mstEdges: number
  totalCost: number
  rejectedEdges: number
  disabled?: boolean
}

export default function ExportReport({ 
  edges, 
  mstEdges, 
  totalCost, 
  rejectedEdges,
  disabled = false 
}: ExportReportProps) {
  
  const generateReport = () => {
    const sortedEdges = [...edges].sort((a, b) => a.weight - b.weight)
    
    const report = `
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           BÃO CÃO THUáº¬T TOÃN KRUSKAL - MST REPORT             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š THá»NG KÃŠ Tá»”NG QUAN:
   â€¢ Tá»•ng sá»‘ Ä‘á»‰nh (V): ${new Set(edges.flatMap(e => [e.source, e.target])).size}
   â€¢ Tá»•ng sá»‘ cáº¡nh (E): ${edges.length}
   â€¢ Cáº¡nh trong MST: ${mstEdges}
   â€¢ Cáº¡nh bá»‹ loáº¡i: ${rejectedEdges}
   â€¢ Tá»•ng chi phÃ­ MST: ${totalCost}

ğŸ“‹ DANH SÃCH Cáº NH (ÄÃƒ Sáº®P Xáº¾P THEO TRá»ŒNG Sá»):
${sortedEdges.map((e, i) => `   ${(i+1).toString().padStart(2, ' ')}. ${e.source} â†’ ${e.target} (trá»ng sá»‘: ${e.weight})`).join('\n')}

ğŸ”¬ PHÃ‚N TÃCH Äá»˜ PHá»¨C Táº P:
   â€¢ Sáº¯p xáº¿p cáº¡nh: O(E log E) = O(${edges.length} Ã— log ${edges.length})
   â€¢ Union-Find: O(E Ã— Î±(V)) â‰ˆ O(${edges.length})
   â€¢ Tá»•ng Ä‘á»™ phá»©c táº¡p: O(E log E)

ğŸ’¡ Káº¾T LUáº¬N:
   Thuáº­t toÃ¡n Kruskal Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c cÃ¢y khung nhá» nháº¥t vá»›i ${mstEdges} cáº¡nh
   vÃ  tá»•ng trá»ng sá»‘ lÃ  ${totalCost}. ÄÃ£ xÃ©t ${edges.length} cáº¡nh, trong Ä‘Ã³
   ${rejectedEdges} cáº¡nh bá»‹ loáº¡i vÃ¬ táº¡o chu trÃ¬nh.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Generated by Kruskal Visualizer | Äá»“ Ã¡n ToÃ¡n Rá»i Ráº¡c
Student: BÃ¹i VÄƒn ChÆ°Æ¡ng | Date: ${new Date().toLocaleString('vi-VN')}
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`
    
    // Download as text file
    const blob = new Blob([report], { type: 'text/plain;charset=utf-8' })
    const url = URL.createObjectURL(blob)
    const link = document.createElement('a')
    link.href = url
    link.download = `Kruskal_Report_${new Date().getTime()}.txt`
    document.body.appendChild(link)
    link.click()
    document.body.removeChild(link)
    URL.revokeObjectURL(url)
  }

  return (
    <Button
      onClick={generateReport}
      disabled={disabled || edges.length === 0}
      className="w-full bg-linear-to-r from-purple-600 to-pink-600 hover:from-purple-500 hover:to-pink-500 text-white font-semibold shadow-lg hover:shadow-purple-500/50 transition-all duration-200"
    >
      ğŸ“¥ Xuáº¥t BÃ¡o CÃ¡o (TXT)
    </Button>
  )
}
